name: ðŸ¤– Telegram â†’ GitHub Action

on:
  schedule:
    # Every 5 minutes (GitHubâ€™s minimum)
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  listen:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Install dependencies
        run: pip install requests

      - name: Poll Telegram and dispatch if needed
        env:
          TELEGRAM_BOT_TOKEN:    ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID:      ${{ secrets.TELEGRAM_CHAT_ID }}
          GITHUB_TOKEN:          ${{ secrets.GITHUB_TOKEN }}
          GITHUB_OWNER:          ${{ github.repository_owner }}
          GITHUB_REPO:           ${{ github.event.repository.name }}
          GITHUB_WORKFLOW_FILE:  'selenium-login.yml'
          GITHUB_REF:            'main'
        run: python .github/scripts/telegram_listener.py
